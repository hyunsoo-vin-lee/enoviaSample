define("UWA/Controls/Web",["UWA/Core","UWA/Utils","UWA/Controls/Abstract","UWA/Class/Timed"],function(g,a,f,d){function b(){var h={};var k,j;for(k=0,j=arguments.length;k<j;k++){h[arguments[k]]=true}return h}var e=b("www.skateslate.com","www.pravdareport.com","blog.alteroot.org");var c=f.extend(d,{defaultOptions:{url:"about:blank",width:"100%",height:"",className:"uwa-web",scrolling:"auto",border:false,sandbox:false,withMessage:false,unsecureWarningMessage:null},init:function(h){this._parent(h);this._frameOnload=this.dispatchAsEventListener("onLoad");this.buildSkeleton()},buildSkeleton:function(){var i,k,j=this.elements,h=this.options;k={width:h.width,height:h.height,scrolling:h.scrolling,frameborder:(h.border?1:0)};if(h.sandbox){k.sandbox="allow-same-origin allow-forms allow-scripts allow-popups"}if(!h.url){h.url="about:blank"}j.container=g.createElement("div",{"class":h.className});j.iframe=i=g.createElement("iframe",k);i.onerror=this.dispatchAsEventListener("onError");if(h.withMessage){j.container.addContent(g.createElement("div",{"class":"uwa-web-message",html:j.loadingMessage=g.createElement("p",{"class":"loading-message"})}));this.addEvent("onLoad",function(){if(this._shouldClearMessage()){j.loadingMessage.empty();return}this.setDelayed("websitemessage",function(){j.loadingMessage.setText(g.i18n("This website prevents embedding via iframe."))},1000)}.bind(this))}j.container.addContent(i);this.setSrc(h.url)},setSrc:function(h){if(!this._isSecureIFrame(h)){this.elements.iframe.removeEvent("load",this._frameOnload);this.elements.iframe.src="about:blank";this.elements.loadingMessage.setText(this.options.unsecureWarningMessage||g.i18n("This app is trying to load unsecure content."))}else{this.elements.iframe.src=h;this.elements.iframe.addEvent("load",this._frameOnload);if(this.options.withMessage){if(h==="about:blank"){this.elements.loadingMessage.empty()}else{this.elements.loadingMessage.setText(g.i18n("Loading\u2026"))}}}},setIFrameHeight:function(h){this.elements.iframe.setStyle("height",h)},isBlank:function(){return this.elements.iframe.src==="about:blank"},getIFrame:function(){return this.elements.iframe},_isSecureIFrame:function(j){var i=a.parseUrl(window.location.href);var h=a.parseUrl(j);return i.protocol==="http"||(i&&i.protocol==="https"&&h&&h.protocol==="https")},_shouldClearMessage:function(){var i=this.elements.iframe.src;if(this.isBlank()||/\.(png|jpe?g|gif|txt)$/i.test(i)){return true}var h=a.parseUrl(i).domain;return g.owns(e,h)}});return g.namespace("Controls/Web",c,g)});